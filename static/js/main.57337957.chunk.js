(this["webpackJsonpweb-phone-verify"]=this["webpackJsonpweb-phone-verify"]||[]).push([[0],{102:function(e,t,o){},113:function(e,t,o){"use strict";o.r(t);var n=o(7),r=o(1),a=o.n(r),i=o(14),s=o.n(i),c=(o(102),o(37)),l=o(38),d=o(43),u=o(42),h=o(79),f=o(17),m=o(55),p=o(152),b=o(8),j=o(150),g=o(141),x=o(142),v=o(143),y=o(144),O=o(145),S=o(147),C=o(148),w=o(146),F=o(63),k=o.n(F),M=o(155),N=o(153),I=Object(b.a)({root:{"& label.Mui-focused":{color:"##1E90FF"},"& .MuiInput-underline:after":{borderBottomColor:"##1E90FF"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#1E90FF"},"&:hover fieldset":{borderColor:"#1E90FF"},"&.Mui-focused fieldset":{borderColor:"##1E90FF"}}}})(j.a),E=function(e){Object(d.a)(o,e);var t=Object(u.a)(o);function o(e){var n;return Object(c.a)(this,o),(n=t.call(this,e)).inputStyles={marginBottom:"20px"},n.state={userName:"",open:!1,errorMessage:null,loading:!1},n}return Object(l.a)(o,[{key:"handleClose",value:function(e,t){"clickaway"!==t&&this.setState({open:!1})}},{key:"handleChangeFormData",value:function(e){var t=e.target.name;this.setState(Object(m.a)({},t,e.target.value.trim()))}},{key:"performSearch",value:function(e){var t=this;e.preventDefault();var o=this,n="https://tarabartest.firebaseio.com/Members/".concat(this.state.userName,".json");fetch(n).then((function(e){return e.json()})).then((function(e){console.log("performSearch() value=",e),e&&"null"!==e&&""!==e?t.props.history.push("/recoveryAccount/".concat(t.state.userName)):(console.log("Member is not found!"),o.setState({open:!0,errorMessage:"Member is not found!",loading:!1}))}),(function(e){console.error("performLogin()",e),o.setState({open:!0,errorMessage:"Sorry, server cannot be communicated.",loading:!1})}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return Object(n.jsxs)(a.a.Fragment,{children:[Object(n.jsx)(g.a,{style:{background:"white"},children:Object(n.jsxs)(p.a,{children:[Object(n.jsx)(x.a,{className:t.demoWrapImg,children:Object(n.jsxs)(v.a,{container:!0,children:[Object(n.jsx)(v.a,{item:!0,xs:1,md:4,lg:4,children:Object(n.jsx)(p.a,{style:{width:"100%"}})}),Object(n.jsxs)(v.a,{item:!0,xs:10,md:4,lg:4,children:[Object(n.jsx)(p.a,{m:3}),Object(n.jsx)(y.a,{style:this.inputStyles,children:Object(n.jsx)(I,{className:t.margin,label:"User Name",variant:"outlined",autoFocus:!0,name:"userName",id:"user-name-outlined-input",required:!0,onChange:function(t){return e.handleChangeFormData(t)}})}),Object(n.jsxs)("div",{style:{position:"relative"},children:[Object(n.jsx)(O.a,{type:"submit",variant:"text",style:{backgroundColor:"#1E90FF",color:"#fff",textTransform:"none",width:"100%",fontSize:"23px",margin:"10mm 0 5mm 0",opacity:this.state.loading?"0.5":"1"},onClick:function(t){return e.performSearch(t)},children:"Search"}),this.state.loading&&Object(n.jsx)(w.a,{size:30,className:t.buttonProgress})]})]})]})}),Object(n.jsxs)(p.a,{className:t.demoWrapText,children:[Object(n.jsx)(S.a,{onClick:function(){e.props.history.goBack()},children:Object(n.jsx)(k.a,{style:{color:"#ffffff"}})}),Object(n.jsx)(p.a,{m:2,children:Object(n.jsx)(C.a,{variant:"h4",align:"center",className:t.title,children:"Password Recovery"})})]})]})}),Object(n.jsx)(M.a,{open:this.state.open,autoHideDuration:6e3,onClose:function(){return e.handleClose()},children:Object(n.jsx)(N.a,{elevation:6,variant:"filled",onClose:function(){return e.handleClose()},severity:"error",children:this.state.errorMessage||"Sorry, something went wrong."})})]})}}]),o}(a.a.Component),P=Object(b.a)((function(e){return{root:{"& .MuiTextField-root":{margin:e.spacing(1)}},demoWrapText:{backgroundColor:"#1E90FF",color:"#ffffff",textTransform:"none",fontSize:"23px",top:"0",left:"0",width:"100%",height:"300px",opicity:1,position:"absolute"},demoWrapImg:{width:"100%",margin:"280px auto",padding:"10px",zIndex:2,position:"relative",textAlign:"center",marginBottom:"0",background:"#ffffff",borderRadius:"5%",maxWidth:"100%"},buttonProgress:{color:" green[500]",position:"absolute",top:"50px",left:"50%",marginLeft:-16}}}),{withTheme:!0})(E),T=o(66),A=o(158),R=o(159),W=o(157),z=o(149),D=o(52);D.a.initializeApp({apiKey:"AIzaSyAD43Q9Oz-PbfJIgFkrPwwEQDHyOE5jYJE",authDomain:"dev1tarabar.firebaseapp.com",databaseURL:"https://dev1tarabar.firebaseio.com",projectId:"dev1tarabar",storageBucket:"dev1tarabar.appspot.com",messagingSenderId:"834633851989",appId:"1:834633851989:web:b5ff73320702d39299e0dc",measurementId:"G-3PQJN89R70"});var B=D.a.auth,J={"& label.Mui-focused":{color:"##1E90FF"},"& .MuiInput-underline:after":{borderBottomColor:"##1E90FF"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#1E90FF"},"&:hover fieldset":{borderColor:"#1E90FF"},"&.Mui-focused fieldset":{borderColor:"##1E90FF"}}},L=new D.a.auth.RecaptchaVerifier("recaptcha-container",{size:"invisible",callback:function(e){console.log("success",e)}}),V=function(e){Object(d.a)(o,e);var t=Object(u.a)(o);function o(e){var n;return Object(c.a)(this,o),(n=t.call(this,e)).inputStyles={marginBottom:"20px"},n.state={verificationCode:"",phoneNo:"",open:!1,errorMessage:null,loading:!1,memberForRecovery:{},hasSMSSuccessfullySent:!1},n}return Object(l.a)(o,[{key:"handleChangeFormData",value:function(e){this.setState({verificationCode:e.target.value.trim()})}},{key:"handleClose",value:function(e,t){"clickaway"!==t&&this.setState({open:!1})}},{key:"componentDidMount",value:function(){this.getMemberAndSendConfirmationCode()}},{key:"getMemberAndSendConfirmationCode",value:function(){var e=this,t=this.props.match.params.userName,o="https://tarabartest.firebaseio.com/Members/".concat(t,".json");this.setState({loading:!0}),fetch(o).then((function(e){return e.text()})).then((function(t){t&&"null"!==t&&""!==t?e.prepareAndSentCodeToPhoneNumber(t):e.setState({open:!0,errorMessage:"User does not exist, please register now.",loading:!1})}),(function(t){console.error("performRecoveryAccountWithPhoneNo()",t),e.setState({open:!0,errorMessage:"Sorry, server cannot be communicated.",loading:!1})}))}},{key:"prepareAndSentCodeToPhoneNumber",value:function(e){var t=this,o=JSON.parse(e);if(o.phoneNo){t.setState({phoneNo:o.phoneNo,loading:!1,memberForRecovery:o});var n="";if(t.state.phoneNo.startsWith("09"))for(var r=t.state.phoneNo.split("09"),a=1;a<r.length;a++)n+=r[a];n="+959".concat(n),B().signInWithPhoneNumber(n,L).then((function(e){console.log("success",e),window.confirmationResult=e,t.setState({hasSMSSuccessfullySent:!0})})).catch((function(e){console.log(e),t.setState({open:!0,errorMessage:e.message,loading:!1})}))}else t.setState({open:!0,errorMessage:"Sorry, user may not have phone number registered.",loading:!1})}},{key:"performRecoveryAccountWithPhoneNo",value:function(e){e.preventDefault();var t=this;window.confirmationResult.confirm(this.state.verificationCode).then((function(e){console.log("Confirmation verification is successfully!"),window.location.href="".concat(window.ref,"tarabar/resources/showmenu/memberDetail/").concat(t.state.memberForRecovery.personCode,"?password_recovery_key=").concat(t.state.verificationCode,"&personCode=").concat(t.state.memberForRecovery.personCode,"&userName=").concat(t.state.memberForRecovery.name)})).catch((function(e){console.log(e),t.setState({open:!0,errorMessage:e.message,loading:!1})}))}},{key:"render",value:function(){var e=this,t=this.props,o=t.classes,r=t.theme,a="Sending SMS confirmation code to ".concat(this.props.match.params.userName,"..."),i="Please wait for the SMS.";return this.state.loading||(this.state.hasSMSSuccessfullySent?(a="SMS confirmation code was sent to ".concat(this.props.match.params.userName,"."),i="Enter the code we sent in the below input."):(a="Sorry",i=this.state.errorMessage)),Object(n.jsxs)(z.a,{theme:r,children:[Object(n.jsx)(p.a,{id:"recaptcha-container"}),Object(n.jsxs)(g.a,{style:{background:"white"},children:[Object(n.jsxs)(p.a,{children:[Object(n.jsx)(x.a,{className:o.demoWrapImg,children:Object(n.jsxs)(v.a,{container:!0,children:[Object(n.jsx)(v.a,{item:!0,xs:1,md:4,lg:4,children:Object(n.jsx)(p.a,{style:{width:"100%"}})}),Object(n.jsxs)(v.a,{item:!0,xs:12,style:{height:"200px"},children:[Object(n.jsx)(C.a,{variant:"h6",children:a}),Object(n.jsx)(C.a,{children:i})]}),this.state.hasSMSSuccessfullySent?Object(n.jsx)(v.a,{item:!0,xs:10,md:4,lg:4,children:Object(n.jsxs)("form",{autoComplete:"off",onSubmit:function(t){return e.performRecoveryAccountWithPhoneNo(t)},children:[Object(n.jsx)("p",{style:{textAlign:"center",fontSize:"18px",color:"#1E90FF"},children:"Verification Code"}),Object(n.jsxs)("p",{style:{textAlign:"center",fontSize:"16px",color:"rgb(117 167 216)"},children:["Please type the verification code sent to ",this.state.phoneNo]}),Object(n.jsxs)(A.a,{variant:"outlined",className:o.commonInputClass,children:[Object(n.jsx)(R.a,{htmlFor:"outlined-adornment-verification",children:"Verification Code"}),Object(n.jsx)(W.a,{name:"verificationCode",required:!0,id:"outlined-adornment-verification",type:"text",value:this.state.verificationCode,onChange:function(t){return e.handleChangeFormData(t)},labelWidth:126})]}),Object(n.jsx)(O.a,{type:"submit",variant:"text",style:{backgroundColor:"#1E90FF",color:"#fff",textTransform:"none",width:"100%",fontSize:"23px",margin:"10mm 0 5mm 0",opacity:this.state.loading?"0.5":"1"},children:"Verify"}),this.state.loading&&Object(n.jsx)(w.a,{size:30,className:o.buttonProgress})]})}):Object(n.jsx)(v.a,{item:!0,xs:12,children:Object(n.jsx)(O.a,{onClick:function(){return e.getMemberAndSendConfirmationCode()},style:{backgroundColor:"grey"},children:"Try again"})})]})}),Object(n.jsxs)(p.a,{className:o.demoWrapText,children:[Object(n.jsx)(S.a,{onClick:function(){e.props.history.goBack()},children:Object(n.jsx)(k.a,{style:{color:"#ffffff"}})}),Object(n.jsx)(p.a,{m:2,children:Object(n.jsx)(C.a,{variant:"h4",align:"center",className:o.title,children:"Password Recovery"})})]})]}),Object(n.jsx)(M.a,{open:this.state.open,autoHideDuration:6e3,onClose:function(){return e.handleClose()},children:Object(n.jsx)(N.a,{elevation:6,variant:"filled",onClose:function(){return e.handleClose()},severity:"error",children:this.state.errorMessage||"Sorry, something went wrong."})})]})]})}}]),o}(a.a.Component),H=Object(b.a)((function(e){return{root:{"& .MuiTextField-root":{margin:e.spacing(1)}},demoWrapText:{backgroundColor:"#1E90FF",color:"#ffffff",textTransform:"none",fontSize:"23px",top:"0",left:"0",width:"100%",height:"300px",opicity:1,position:"absolute"},demoWrapImg:{width:"100%",margin:"280px auto",padding:"10px",zIndex:2,position:"relative",textAlign:"center",marginBottom:"0",background:"#ffffff",borderRadius:"5%",maxWidth:"100%"},commonInputClass:Object(T.a)(Object(T.a)({},J),{},{width:"100%"}),wrapper:{margin:e.spacing(1),position:"relative"},buttonSuccess:{backgroundColor:"green[500]","&:hover":{backgroundColor:"green[700]"}},buttonProgress:{color:" green[500]",position:"absolute",top:"70%",left:"50%",marginTop:-12,marginLeft:-12},title:{"line-height":"55px","-webkit-line-clamp":4,"-webkit-box-orient":"vertical","text-overflow":"ellipsis",overflow:"hidden",display:"-webkit-box"}}}),{withTheme:!0})(V),Q=function(e){Object(d.a)(o,e);var t=Object(u.a)(o);function o(e){var n;return Object(c.a)(this,o),n=t.call(this,e),window.ref=document.referrer.split("/tarabar")[0],n}return Object(l.a)(o,[{key:"render",value:function(){return Object(n.jsx)(h.a,{basename:"/web-phone-verify",children:Object(n.jsxs)(f.c,{children:[Object(n.jsx)(f.a,{path:"/recoveryAccount/:userName",component:H}),Object(n.jsx)(f.a,{component:P})]})})}}]),o}(r.Component),U=function(e){e&&e instanceof Function&&o.e(3).then(o.bind(null,161)).then((function(t){var o=t.getCLS,n=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;o(e),n(e),r(e),a(e),i(e)}))};s.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(Q,{})}),document.getElementById("root")),U()}},[[113,1,2]]]);
//# sourceMappingURL=main.57337957.chunk.js.map